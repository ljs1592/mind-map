<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1">
  <link rel="icon" href="dist/logo.ico">
  <title>æ€ç»ªæ€ç»´å¯¼å›¾ - Modern ä¸»é¢˜ + ä»»åŠ¡å‹¾é€‰</title>
  <script>
    // è‡ªå®šä¹‰é™æ€èµ„æºçš„è·¯å¾„
    window.externalPublicPath = './dist/'
    // æ¥ç®¡åº”ç”¨ - è®¾ç½®ä¸º true ä»¥ä½¿ç”¨è‡ªå®šä¹‰æ•°æ®å’Œé…ç½®
    window.takeOverApp = true
  </script>
  <link href="dist/css/chunk-vendors.css" rel="stylesheet">
  <link href="dist/css/app.css" rel="stylesheet">
</head>
<body>
  <noscript>
    <strong>We're sorry but thoughts doesn't work properly without JavaScript enabled. Please enable it to continue.</strong>
  </noscript>
  <div id="app"></div>
  
  <script>
    // ä»åç«¯è·å–æ•°æ®çš„å‡½æ•°ï¼ˆè¿™é‡Œä½¿ç”¨ç¤ºä¾‹æ•°æ®ï¼‰
    const getDataFromBackend = () => {
      return new Promise((resolve, reject) => {
        setTimeout(() => {
          resolve({
            // æ€ç»´å¯¼å›¾æ•°æ®
            mindMapData: {
              root: {
                data: {
                  text: 'ğŸ“‹ é¡¹ç›®å¼€å‘è®¡åˆ’',
                  taskChecked: false
                },
                children: [
                  {
                    data: {
                      text: 'éœ€æ±‚åˆ†æé˜¶æ®µ',
                      taskChecked: false
                    },
                    children: [
                      {
                        data: {
                          text: 'æ”¶é›†ç”¨æˆ·éœ€æ±‚',
                          taskChecked: true
                        },
                        children: []
                      },
                      {
                        data: {
                          text: 'ç¼–å†™éœ€æ±‚æ–‡æ¡£',
                          taskChecked: true
                        },
                        children: []
                      },
                      {
                        data: {
                          text: 'éœ€æ±‚è¯„å®¡ä¼šè®®',
                          taskChecked: false
                        },
                        children: []
                      }
                    ]
                  },
                  {
                    data: {
                      text: 'è®¾è®¡é˜¶æ®µ',
                      taskChecked: false
                    },
                    children: [
                      {
                        data: {
                          text: 'UI/UX è®¾è®¡',
                          taskChecked: true
                        },
                        children: []
                      },
                      {
                        data: {
                          text: 'æ•°æ®åº“è®¾è®¡',
                          taskChecked: true
                        },
                        children: []
                      },
                      {
                        data: {
                          text: 'API æ¥å£è®¾è®¡',
                          taskChecked: false
                        },
                        children: []
                      }
                    ]
                  },
                  {
                    data: {
                      text: 'å¼€å‘é˜¶æ®µ',
                      taskChecked: false
                    },
                    children: [
                      {
                        data: {
                          text: 'å‰ç«¯å¼€å‘',
                          taskChecked: false
                        },
                        children: [
                          {
                            data: {
                              text: 'é¡µé¢ç»„ä»¶å¼€å‘',
                              taskChecked: false
                            },
                            children: []
                          },
                          {
                            data: {
                              text: 'çŠ¶æ€ç®¡ç†å®ç°',
                              taskChecked: false
                            },
                            children: []
                          }
                        ]
                      },
                      {
                        data: {
                          text: 'åç«¯å¼€å‘',
                          taskChecked: false
                        },
                        children: [
                          {
                            data: {
                              text: 'API æ¥å£å®ç°',
                              taskChecked: false
                            },
                            children: []
                          },
                          {
                            data: {
                              text: 'æ•°æ®åº“å®ç°',
                              taskChecked: false
                            },
                            children: []
                          }
                        ]
                      }
                    ]
                  },
                  {
                    data: {
                      text: 'æµ‹è¯•é˜¶æ®µ',
                      taskChecked: false
                    },
                    children: [
                      {
                        data: {
                          text: 'å•å…ƒæµ‹è¯•',
                          taskChecked: false
                        },
                        children: []
                      },
                      {
                        data: {
                          text: 'é›†æˆæµ‹è¯•',
                          taskChecked: false
                        },
                        children: []
                      }
                    ]
                  }
                ]
              },
              theme: {
                template: 'modern',  // ä½¿ç”¨ modern ä¸»é¢˜
                config: {}
              },
              layout: 'logicalStructure',
              config: {},
              view: null
            },
            // æ€ç»´å¯¼å›¾é…ç½®
            mindMapConfig: {
              // æ·»åŠ å‹¾é€‰æ¡†åˆ°èŠ‚ç‚¹å‰ç½®å†…å®¹
              createNodePrefixContent: function(node) {
                if (window.mindMapInstance && window.mindMapInstance.taskCheckbox) {
                  return window.mindMapInstance.taskCheckbox.createCheckboxContent(node)
                }
                return null
              }
            },
            lang: 'zh',
            localConfig: null
          })
        }, 200)
      })
    }

    // è®¾ç½®æ¥ç®¡åº”ç”¨çš„æ–¹æ³•
    const setTakeOverAppMethods = data => {
      window.takeOverAppMethods = {}
      
      // è·å–æ€ç»´å¯¼å›¾æ•°æ®çš„å‡½æ•°
      window.takeOverAppMethods.getMindMapData = () => {
        return data.mindMapData
      }
      
      // ä¿å­˜æ€ç»´å¯¼å›¾æ•°æ®çš„å‡½æ•°
      window.takeOverAppMethods.saveMindMapData = data => {
        console.log('ä¿å­˜æ€ç»´å¯¼å›¾æ•°æ®:', data)
        // è¿™é‡Œå¯ä»¥æ·»åŠ ä¿å­˜åˆ°åç«¯çš„é€»è¾‘
      }
      
      // è·å–æ€ç»´å¯¼å›¾é…ç½®
      window.takeOverAppMethods.getMindMapConfig = () => {
        return data.mindMapConfig
      }
      
      // ä¿å­˜æ€ç»´å¯¼å›¾é…ç½®
      window.takeOverAppMethods.saveMindMapConfig = config => {
        console.log('ä¿å­˜æ€ç»´å¯¼å›¾é…ç½®:', config)
      }
      
      // è·å–è¯­è¨€çš„å‡½æ•°
      window.takeOverAppMethods.getLanguage = () => {
        return data.lang
      }
      
      // ä¿å­˜è¯­è¨€çš„å‡½æ•°
      window.takeOverAppMethods.saveLanguage = lang => {
        console.log('ä¿å­˜è¯­è¨€:', lang)
      }
      
      // è·å–æœ¬åœ°é…ç½®çš„å‡½æ•°
      window.takeOverAppMethods.getLocalConfig = () => {
        return data.localConfig
      }
      
      // ä¿å­˜æœ¬åœ°é…ç½®çš„å‡½æ•°
      window.takeOverAppMethods.saveLocalConfig = config => {
        console.log('ä¿å­˜æœ¬åœ°é…ç½®:', config)
      }
    }

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    window.onload = async () => {
      if (!window.takeOverApp) return
      
      // è¯·æ±‚æ•°æ®
      const data = await getDataFromBackend()
      
      // è®¾ç½®å…¨å±€çš„æ–¹æ³•
      setTakeOverAppMethods(data)
      
      // æ€ç»´å¯¼å›¾å®ä¾‹åˆ›å»ºå®Œæˆäº‹ä»¶
      window.$bus.$on('app_inited', mindMap => {
        console.log('æ€ç»´å¯¼å›¾å®ä¾‹åˆ›å»ºå®Œæˆ:', mindMap)
        // å°†å®ä¾‹ä¿å­˜åˆ°å…¨å±€ï¼Œä»¥ä¾¿ createNodePrefixContent å¯ä»¥è®¿é—®
        window.mindMapInstance = mindMap
        
        // ç›‘å¬èŠ‚ç‚¹ç‚¹å‡»äº‹ä»¶
        mindMap.on('node_click', (node) => {
          console.log('èŠ‚ç‚¹ç‚¹å‡»:', node.nodeData.data)
        })
        
        // ç›‘å¬æ•°æ®å˜åŒ–
        mindMap.on('data_change', (data) => {
          console.log('æ•°æ®å˜åŒ–')
        })
      })
      
      // å®ä¾‹åŒ–é¡µé¢
      window.initApp()
    }
  </script>
  
  <script src="dist/js/chunk-vendors.js"></script>
  <script src="dist/js/app.js"></script>
</body>
</html>

