# GitHub Packages æ¨é€æµç¨‹æ–‡æ¡£


## ğŸ¯ æ ¸å¿ƒæµç¨‹æ€»ç»“ï¼š
ç®€å•æ¥è¯´ï¼Œä½ éœ€è¦ï¼š
- ä¿®æ”¹ simple-mind-map/package.json ä¸­çš„ç‰ˆæœ¬å·ï¼ˆå¦‚ v1.0.11ï¼‰
- æäº¤ä»£ç ï¼šgit commit -m "chore: bump version to v1.0.11"
- åˆ›å»ºæ ‡ç­¾ï¼šgit tag v1.0.11
- æ¨é€æ ‡ç­¾ï¼šgit push origin v1.0.11
- GitHub Actions ä¼šè‡ªåŠ¨å®Œæˆæ„å»ºå’Œå‘å¸ƒ

## æ¦‚è¿°

æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•å°† `simple-mind-map` åŒ…å‘å¸ƒåˆ° GitHub Packagesã€‚å‘å¸ƒè¿‡ç¨‹é€šè¿‡ GitHub Actions è‡ªåŠ¨åŒ–å®Œæˆï¼Œå½“æ¨é€ç¬¦åˆç‰¹å®šæ ¼å¼çš„æ ‡ç­¾æ—¶è‡ªåŠ¨è§¦å‘ã€‚

## ğŸ“¦ åŒ…ä¿¡æ¯

- **åŒ…å**: `@ljs1592/simple-mind-map`
- **å½“å‰ç‰ˆæœ¬**: `v1.0.10`
- **å‘å¸ƒä»“åº“**: GitHub Packages
- **æ³¨å†Œè¡¨åœ°å€**: `https://npm.pkg.github.com/`
- **åŒ…å«å†…å®¹**: 
  - `dist/` - æ‰“åŒ…åçš„ç”Ÿäº§æ–‡ä»¶
  - `types/` - TypeScript ç±»å‹å®šä¹‰
  - `src/` - å®Œæ•´æºä»£ç ï¼ˆä¾¿äºè°ƒè¯•ï¼‰
  - `index.js` - å…¥å£æ–‡ä»¶
  - `full.js` - åŒ…å«æ‰€æœ‰æ’ä»¶çš„å®Œæ•´ç‰ˆæœ¬


## ğŸš€ å‘å¸ƒæµç¨‹

### 1. å‰ç½®æ¡ä»¶

åœ¨å¼€å§‹å‘å¸ƒä¹‹å‰ï¼Œç¡®ä¿ï¼š

- [ ] ä½ æœ‰ä»“åº“çš„å†™å…¥æƒé™
- [ ] æœ¬åœ°ä»£ç å·²æäº¤åˆ° GitHub
- [ ] ä»£ç å·²ç»è¿‡æµ‹è¯•ï¼Œç¡®ä¿åŠŸèƒ½æ­£å¸¸
- [ ] å·²æ›´æ–° `simple-mind-map/package.json` ä¸­çš„ç‰ˆæœ¬å·

### 2. æ›´æ–°ç‰ˆæœ¬å·

ç¼–è¾‘ `simple-mind-map/package.json` æ–‡ä»¶ï¼Œæ›´æ–°ç‰ˆæœ¬å·ï¼š

```json
{
  "name": "@ljs1592/simple-mind-map",
  "version": "v1.0.11",  // æ›´æ–°è¿™é‡Œçš„ç‰ˆæœ¬å·
  // ... å…¶ä»–é…ç½®
}
```

**ç‰ˆæœ¬å·è§„èŒƒ**ï¼š
- æ ¼å¼ï¼š`vä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.ä¿®è®¢ç‰ˆæœ¬`ï¼ˆä¾‹å¦‚ï¼š`v1.0.11`ï¼‰
- ä¸»ç‰ˆæœ¬ï¼šé‡å¤§åŠŸèƒ½å˜æ›´æˆ–ä¸å…¼å®¹çš„ API ä¿®æ”¹
- æ¬¡ç‰ˆæœ¬ï¼šå‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ–°å¢
- ä¿®è®¢ç‰ˆæœ¬ï¼šå‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®æ­£

### 3. æäº¤ä»£ç 

```bash
# æ·»åŠ ä¿®æ”¹çš„æ–‡ä»¶
git add simple-mind-map/package.json

# æäº¤æ›´æ”¹
git commit -m "chore: bump version to v1.0.11"

# æ¨é€åˆ°è¿œç¨‹ä»“åº“
git push origin main
```

### 4. åˆ›å»ºå¹¶æ¨é€ç‰ˆæœ¬æ ‡ç­¾

GitHub Actions å·¥ä½œæµä¼šåœ¨æ£€æµ‹åˆ° `v*.*.*` æ ¼å¼çš„æ ‡ç­¾æ—¶è‡ªåŠ¨è§¦å‘ã€‚

```bash
# åˆ›å»ºæ ‡ç­¾ï¼ˆç‰ˆæœ¬å·è¦ä¸ package.json ä¸­çš„ä¸€è‡´ï¼‰
git tag v1.0.11

# æ¨é€æ ‡ç­¾åˆ°è¿œç¨‹ä»“åº“
git push origin v1.0.11
```

**é‡è¦æç¤º**ï¼š
- æ ‡ç­¾æ ¼å¼å¿…é¡»æ˜¯ `v*.*.*`ï¼ˆä¾‹å¦‚ï¼š`v1.0.11`ã€`v2.1.0`ï¼‰
- æ ‡ç­¾ç‰ˆæœ¬åº”è¯¥ä¸ `package.json` ä¸­çš„ç‰ˆæœ¬å·ä¿æŒä¸€è‡´

### 5. ç›‘æ§å‘å¸ƒè¿‡ç¨‹

æ¨é€æ ‡ç­¾åï¼ŒGitHub Actions ä¼šè‡ªåŠ¨å¼€å§‹æ„å»ºå’Œå‘å¸ƒæµç¨‹ï¼š

1. è®¿é—®ä»“åº“çš„ **Actions** æ ‡ç­¾é¡µ
2. æ‰¾åˆ° "Publish package to GitHub Packages" å·¥ä½œæµ
3. æŸ¥çœ‹æœ€æ–°çš„è¿è¡ŒçŠ¶æ€

å·¥ä½œæµå°†æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š
- âœ… æ£€å‡ºä»£ç 
- âœ… è®¾ç½® Node.js 18 ç¯å¢ƒ
- âœ… å®‰è£… web é¡¹ç›®ä¾èµ–
- âœ… å®‰è£… simple-mind-map é¡¹ç›®ä¾èµ–
- âœ… æ„å»ºåº“æ–‡ä»¶ï¼ˆä» web ç›®å½•æ„å»ºåˆ° simple-mind-map/distï¼‰
- âœ… å‘å¸ƒåˆ° GitHub Packages

### 6. éªŒè¯å‘å¸ƒç»“æœ

å‘å¸ƒæˆåŠŸåï¼š

1. åœ¨ä»“åº“é¡µé¢å³ä¾§æ‰¾åˆ° **Packages** éƒ¨åˆ†
2. ç‚¹å‡»è¿›å…¥åŒ…è¯¦æƒ…é¡µ
3. ç¡®è®¤æ–°ç‰ˆæœ¬å·²ç»å‘å¸ƒ

æˆ–è€…é€šè¿‡å‘½ä»¤è¡ŒéªŒè¯ï¼š

```bash
# æŸ¥çœ‹åŒ…çš„æ‰€æœ‰ç‰ˆæœ¬
npm view @ljs1592/simple-mind-map versions
```

## ğŸ“– ä½¿ç”¨å‘å¸ƒçš„åŒ…

### å®‰è£…åŒ…

å…¶ä»–é¡¹ç›®å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®‰è£…ä½ å‘å¸ƒçš„åŒ…ï¼š

#### æ–¹æ³• 1ï¼šä½¿ç”¨ .npmrc é…ç½®

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºæˆ–ç¼–è¾‘ `.npmrc` æ–‡ä»¶ï¼š

```
@ljs1592:registry=https://npm.pkg.github.com/
//npm.pkg.github.com/:_authToken=YOUR_GITHUB_TOKEN
```

ç„¶åå®‰è£…ï¼š

```bash
npm install @ljs1592/simple-mind-map
```

#### æ–¹æ³• 2ï¼šç›´æ¥æŒ‡å®šæ³¨å†Œè¡¨

```bash
npm install @ljs1592/simple-mind-map --registry=https://npm.pkg.github.com/
```

### ç”Ÿæˆ GitHub Token

è¦å®‰è£…ç§æœ‰åŒ…ï¼Œéœ€è¦ GitHub Personal Access Tokenï¼š

1. è®¿é—® GitHub Settings â†’ Developer settings â†’ Personal access tokens â†’ Tokens (classic)
2. ç‚¹å‡» "Generate new token (classic)"
3. é€‰æ‹©ä»¥ä¸‹æƒé™ï¼š
   - `read:packages` - è¯»å–åŒ…
   - `write:packages` - å‘å¸ƒåŒ…ï¼ˆå¦‚æœéœ€è¦ï¼‰
4. ç”Ÿæˆå¹¶ä¿å­˜ token

### è°ƒè¯•æºä»£ç 

å‘å¸ƒçš„åŒ…åŒ…å«å®Œæ•´çš„æºä»£ç ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨ `node_modules/@ljs1592/simple-mind-map/src/` ç›®å½•ä¸‹æŸ¥çœ‹å’Œè°ƒè¯•æºä»£ç ã€‚

**ä½¿ç”¨æºä»£ç çš„æ–¹å¼**ï¼š

1. **æŸ¥çœ‹æºä»£ç ä½ç½®**ï¼š
```bash
# å®‰è£…åŒ…å
cd node_modules/@ljs1592/simple-mind-map
ls -la  # å¯ä»¥çœ‹åˆ° src/ ç›®å½•
```

2. **åœ¨è°ƒè¯•å·¥å…·ä¸­è®¾ç½®æ–­ç‚¹**ï¼š
   - æµè§ˆå™¨å¼€å‘è€…å·¥å…·ä¸­å¯ä»¥ç›´æ¥æ‰¾åˆ° `node_modules/@ljs1592/simple-mind-map/src/` ä¸‹çš„æ–‡ä»¶
   - VS Code ç­‰ IDE ä¸­å¯ä»¥ç›´æ¥æ‰“å¼€ `node_modules` ä¸‹çš„æºæ–‡ä»¶è¿›è¡ŒæŸ¥çœ‹

3. **ç›´æ¥å¼•ç”¨æºä»£ç **ï¼ˆå¯é€‰ï¼‰ï¼š
```javascript
// å¦‚æœéœ€è¦ï¼Œä½ å¯ä»¥ç›´æ¥å¼•ç”¨æºä»£ç è€Œä¸æ˜¯æ‰“åŒ…åçš„ç‰ˆæœ¬
import MindMap from '@ljs1592/simple-mind-map/src/index.js'
// æˆ–å¼•ç”¨å®Œæ•´ç‰ˆæœ¬çš„æºä»£ç 
import MindMap from '@ljs1592/simple-mind-map/full.js'
```

**æ³¨æ„äº‹é¡¹**ï¼š
- æºä»£ç ä½¿ç”¨ ES6+ è¯­æ³•ï¼Œç¡®ä¿ä½ çš„æ„å»ºå·¥å…·é…ç½®æ­£ç¡®
- å¦‚æœç›´æ¥å¼•ç”¨æºç ï¼Œå¯èƒ½éœ€è¦é…ç½®ç›¸åº”çš„ loader å’Œ babel è½¬è¯‘

## ğŸ”§ GitHub Actions å·¥ä½œæµè¯¦è§£

å·¥ä½œæµé…ç½®æ–‡ä»¶ä½äºï¼š`.github/workflows/publish.yml`

### è§¦å‘æ¡ä»¶

```yaml
on:
  push:
    tags:
      - 'v*.*.*'  # åŒ¹é… v1.0.0ã€v2.1.3 ç­‰æ ¼å¼çš„æ ‡ç­¾
```

### æ„å»ºæ­¥éª¤

```yaml
steps:
  # 1. æ£€å‡ºä»£ç 
  - name: Checkout repo
    uses: actions/checkout@v4

  # 2. è®¾ç½® Node.js ç¯å¢ƒ
  - name: Use Node.js 18
    uses: actions/setup-node@v4
    with:
      node-version: '18'
      registry-url: 'https://npm.pkg.github.com/'

  # 3. å®‰è£… web é¡¹ç›®ä¾èµ–
  - name: Install web dependencies
    run: npm ci --prefix ./web

  # 4. å®‰è£… simple-mind-map ä¾èµ–
  - name: Install simple-mind-map dependencies
    run: npm ci --prefix ./simple-mind-map

  # 5. æ„å»ºåº“æ–‡ä»¶
  - name: Build library
    run: npm run buildLibrary --prefix ./web

  # 6. å‘å¸ƒåˆ° GitHub Packages
  - name: Publish to GitHub Packages
    env:
      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
    run: |
      cd ./simple-mind-map
      npm publish --registry https://npm.pkg.github.com/
```

### æ„å»ºæµç¨‹è¯´æ˜

1. **ä¾èµ–å®‰è£…**ï¼šä½¿ç”¨ `npm ci` è€Œä¸æ˜¯ `npm install`ï¼Œç¡®ä¿ä¾èµ–ç‰ˆæœ¬çš„ä¸€è‡´æ€§
2. **æ„å»ºè¿‡ç¨‹**ï¼š
   - æ‰§è¡Œ `web` ç›®å½•ä¸‹çš„ `buildLibrary` è„šæœ¬
   - è„šæœ¬ä¼šæ›´æ–°ç‰ˆæœ¬å·å¹¶ä½¿ç”¨ Vue CLI å’Œ esbuild æ„å»ºåº“æ–‡ä»¶
   - è¾“å‡ºæ–‡ä»¶åˆ° `simple-mind-map/dist` ç›®å½•
3. **å‘å¸ƒ**ï¼šä½¿ç”¨ GitHub è‡ªåŠ¨æä¾›çš„ `GITHUB_TOKEN` è¿›è¡Œè®¤è¯å’Œå‘å¸ƒ

## âš ï¸ å¸¸è§é—®é¢˜

### 1. å‘å¸ƒå¤±è´¥ï¼šæƒé™ä¸è¶³

**é—®é¢˜**ï¼š`npm publish` æ—¶å‡ºç° 403 é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®ä¿ `package.json` ä¸­çš„ `name` å­—æ®µä»¥ `@ä½ çš„GitHubç”¨æˆ·å/` å¼€å¤´
- æ£€æŸ¥å·¥ä½œæµæƒé™è®¾ç½®ï¼ˆä»“åº“ Settings â†’ Actions â†’ General â†’ Workflow permissionsï¼‰

### 2. æ ‡ç­¾æ¨é€åå·¥ä½œæµæœªè§¦å‘

**é—®é¢˜**ï¼šæ¨é€æ ‡ç­¾å Actions æ²¡æœ‰è¿è¡Œ

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥æ ‡ç­¾æ ¼å¼æ˜¯å¦ä¸º `v*.*.*`
- ç¡®è®¤ `.github/workflows/publish.yml` æ–‡ä»¶å·²æäº¤åˆ°ä¸»åˆ†æ”¯

### 3. æ„å»ºå¤±è´¥ï¼šæ‰¾ä¸åˆ°ä¾èµ–

**é—®é¢˜**ï¼š`npm ci` å¤±è´¥ï¼Œæç¤ºæ‰¾ä¸åˆ°æŸäº›åŒ…

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®ä¿ `package-lock.json` æ–‡ä»¶å·²æäº¤
- æ£€æŸ¥ä¾èµ–ç‰ˆæœ¬æ˜¯å¦æ­£ç¡®

### 4. ç‰ˆæœ¬å·å†²çª

**é—®é¢˜**ï¼šå‘å¸ƒæ—¶æç¤ºç‰ˆæœ¬å·å·²å­˜åœ¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä¸èƒ½é‡å¤å‘å¸ƒç›¸åŒç‰ˆæœ¬å·
- å¿…é¡»æ›´æ–° `package.json` ä¸­çš„ç‰ˆæœ¬å·ä¸ºæ–°ç‰ˆæœ¬
- ç¡®ä¿æ ‡ç­¾ç‰ˆæœ¬ä¸ package.json ç‰ˆæœ¬ä¸€è‡´

## ğŸ“ æœ€ä½³å®è·µ

1. **ç‰ˆæœ¬ç®¡ç†**ï¼š
   - éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒï¼ˆSemantic Versioningï¼‰
   - åœ¨ CHANGELOG ä¸­è®°å½•æ¯ä¸ªç‰ˆæœ¬çš„å˜æ›´

2. **å‘å¸ƒå‰æ£€æŸ¥**ï¼š
   - åœ¨æœ¬åœ°è¿è¡Œ `npm run buildLibrary --prefix ./web` ç¡®ä¿æ„å»ºæˆåŠŸ
   - æ£€æŸ¥ `simple-mind-map/dist` ç›®å½•æ˜¯å¦ç”Ÿæˆäº†æ­£ç¡®çš„æ–‡ä»¶

3. **æ ‡ç­¾ç®¡ç†**ï¼š
   - ä¸è¦åˆ é™¤å·²å‘å¸ƒçš„æ ‡ç­¾
   - å¦‚æœéœ€è¦ä¿®å¤å·²å‘å¸ƒçš„ç‰ˆæœ¬ï¼Œå‘å¸ƒä¸€ä¸ªæ–°çš„ä¿®è®¢ç‰ˆæœ¬

4. **æ–‡æ¡£æ›´æ–°**ï¼š
   - å‘å¸ƒæ–°ç‰ˆæœ¬æ—¶æ›´æ–° README.md
   - è®°å½•é‡è¦çš„ API å˜æ›´å’Œè¿ç§»æŒ‡å—

## ğŸ”— ç›¸å…³é“¾æ¥

- [GitHub Packages æ–‡æ¡£](https://docs.github.com/cn/packages)
- [npm å‘å¸ƒæ–‡æ¡£](https://docs.npmjs.com/cli/v8/commands/npm-publish)
- [è¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ](https://semver.org/lang/zh-CN/)
- [GitHub Actions æ–‡æ¡£](https://docs.github.com/cn/actions)

## ğŸ“ é—®é¢˜åé¦ˆ

å¦‚æœåœ¨å‘å¸ƒè¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ï¼š

1. æŸ¥çœ‹ GitHub Actions è¿è¡Œæ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯
2. æ£€æŸ¥æœ¬æ–‡æ¡£çš„"å¸¸è§é—®é¢˜"éƒ¨åˆ†
3. åœ¨ä»“åº“ä¸­åˆ›å»º Issue æè¿°é—®é¢˜

---

**æœ€åæ›´æ–°æ—¶é—´**ï¼š2025-11-04

